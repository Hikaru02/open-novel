{"version":3,"file":"メイン.js","sources":["@traceur/generated/TemplateParser/3","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/1","H:/DataBOX/myFiles/GitHub/open-novel/エンジン/プログラム/ES6/ヘルパー.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/6","H:/DataBOX/myFiles/GitHub/open-novel/エンジン/プログラム/ES6/モデル.js","H:/DataBOX/myFiles/GitHub/open-novel/エンジン/プログラム/ES6/ビュー.js","H:/DataBOX/myFiles/GitHub/open-novel/エンジン/プログラム/ES6/コントローラー.js"],"names":[],"mappings":"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","sourcesContent":["System.register($__placeholder__0, [], $__placeholder__1);","function() {\n      $__placeholder__0\n    }","var __moduleName = $__placeholder__0;",";( _ => {\r\n\t'use strict'\r\n\r\n\tvar global = (1,eval)('this')\r\n\tvar Promise = global.Promise\r\n\tvar LOG = console.log.bind(console)\r\n\r\n\tvar Data = {\r\n\t\tURL: {\r\n\t\t\tContentsSetting: 'データ/作品.txt',\r\n\t\t\tEngineSetting: 'エンジン/エンジン定義.txt',\r\n\t\t},\r\n\t}\r\n\r\n\tvar Util = {\r\n\r\n\t\t//setDefault(obj, name, value) {\r\n\t\t//\tif (arguments.length !== 3) throw 'illegal arguments length'\r\n\t\t//\tif (!(name in obj)) obj[name] = value\r\n\t\t//\treturn obj\r\n\t\t//},\r\n\r\n\t\tsetDefaults(obj = {}, props) {\r\n\t\t\tif (arguments.length !== 2) throw 'illegal arguments length'\r\n\t\t\tObject.keys(props).forEach(key => { if (!(key in obj)) obj[key] = props[key] })\r\n\t\t\treturn obj\r\n\t\t},\r\n\r\n\t\tsetProperties(obj = {}, props) {\r\n\t\t\tObject.keys(props).forEach(key => obj[key] = props[key] )\r\n\t\t\treturn obj\r\n\t\t},\r\n\r\n\t\tisNoneType(str) {\r\n\t\t\treturn (typeof str === 'string') && /^(無し|なし)$/.test(str)\r\n\t\t},\r\n\r\n\t\tforceImageURL(url, type = 'png', kind) {\r\n\t\t\treturn Util.isNoneType(url) ? null :  Util.forceURL(url, type, kind)\r\n\t\t},\r\n\r\n\t\tforceFDImageURL(url, type = 'png', kind = '立ち絵') {\r\n\t\t\treturn Util.isNoneType(url) ? null :  Util.forceURL(url, type, kind)\r\n\t\t},\r\n\r\n\t\tforceBGImageURL(url, type = 'png', kind = '背景') {\r\n\t\t\treturn Util.isNoneType(url) ? null :  Util.forceURL(url, type, kind)\r\n\t\t},\r\n\r\n\t\tforceScriptURL(url, type = 'txt', kind = 'シナリオ') {\r\n\t\t\treturn Util.forceURL(url, type, kind)\r\n\t\t},\r\n\r\n\t\tforceURL(url, type, kind) {\r\n\t\t\tif (!url || arguments.length != 3) throw 'URL特定不能エラー'\r\n\t\t\tif (!url.match(/\\.[^\\.]+$/)) url = `${url}.${type}`\r\n\t\t\tvar base = Player.baseURL || ''\r\n\t\t\tif (kind && (!url.match(kind))) url = `データ/${base}/${kind}/${url}`\r\n\t\t\turl = url.replace(/\\/+/g, '/')\r\n\t\t\treturn url\r\n\t\t},\r\n\r\n\t\tNOP() {},\r\n\r\n\t\terror(message) { alert(message) },\r\n\r\n\t\tDefault: undefined,\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n\tUtil.setDefaults(String.prototype, {\r\n\t\trepeat: function repeat(num) {\r\n\t\t\treturn new Array(num + 1).join(this)\r\n\t\t},\r\n\t})\r\n\r\n\r\n\tUtil.setDefaults(Promise, {\r\n\r\n\t\tdefer() {\r\n\t\t\tvar resolve, reject\r\n\t\t\tvar promise = new Promise((ok, ng) => {\r\n\t\t  \t\tresolve = ok, reject = ng\r\n\t\t\t})\r\n\t\t\treturn {promise, resolve, reject}\r\n\t\t},\r\n\r\n\t})\r\n\r\n\r\n\r\n\tUtil.setProperties(Promise.prototype, {\r\n\r\n\t\tnext: function next(kind, onFulfilled, onRejected) {\r\n\t\t\treturn this.then( result => {\r\n\t\t\t\tPlayer.setRunPhase(kind)\r\n\t\t\t\treturn onFulfilled(result)\r\n\t\t\t}, onRejected).catch(err => {\r\n\t\t\t\tLOG(kind + 'エラー', err)\r\n\t\t\t\tPlayer.setErrorPhase(kind)\r\n\t\t\t\treturn Promise.reject(err)\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\ton: function on(type, onFulfilled = result => result, onRejected) {\r\n\t\t\treturn this.then( result => View.on(type).then( _ => onFulfilled(result) ).catch(onRejected) )\r\n\t\t},\r\n\r\n\t\tand: function and(func, arg) {\r\n\t\t\treturn this.then( _ => func(arg) )\r\n\t\t},\r\n\r\n\t\tdelay: function delay(time) {\r\n\t\t\tif (!+time) throw 'illegal time number'\r\n\t\t\treturn this.then( _ => new Promise( resolve => setTimeout(resolve, time) ) )\r\n\t\t},\r\n\t})\r\n\r\n\tObject.defineProperty(Promise.prototype, '$', {\r\n\t\tenumerable: true, configurable: true, \r\n\t\tget: function () {\r\n\t\t\tvar _p = this\r\n\t\t\tvar $p = function (...args) {\r\n\t \t\t\tvar len = args.length\r\n\t \t\t\tif (len === 0) return $p\r\n\t \t\t\tvar [arg0, arg1, arg2] = args\r\n\r\n\t \t\t\tif (typeof arg0 == 'function') {\r\n\t\t \t\t\tswitch (args.length) {\r\n\t\t\t\t\t\tcase 1: \r\n\t\t\t\t\t\tcase 2: return _p.then(arg0).$\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t \t\t\tswitch (args.length) {\r\n\t\t\t\t\t\tcase 1: return _p.on(arg0).$\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tcase 3: return _p.next(arg0, arg1, arg2).$\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthrow 'illegal arguments length'\r\n\t\t\t}\r\n\t\t\tUtil.setProperties($p, {\r\n\t\t\t\tthen: (res, rej) => _p.then(res, rej).$ ,\r\n\t\t\t\tcatch: rej => _p.catch(rej).$ ,\r\n\t\t\t})\r\n\t\t\tObject.defineProperty($p, '_', {\r\n\t\t\t\tenumerable: true, configurable: true,\r\n\t\t\t\tget: _ => _p\r\n\t\t\t})\r\n\t\t\t$p.__proto__ = _p\r\n\t\t\treturn $p\r\n\t\t}\r\n\t})\r\n\r\n\tfunction $Promise(func) {\r\n\t\treturn new Promise(func).$\r\n\t}\r\n\r\n\tUtil.setProperties($Promise, {\r\n\t\tdefer: _ => {\r\n\t\t\tvar defer = Promise.defer()\r\n\t\t\tdefer.promise = defer.promise.$\r\n\t\t\treturn defer\r\n\t\t},\r\n\t\tresolve: val => Promise.resolve(val).$ ,\r\n\t\treject : val => Promise.reject(val).$ ,\r\n\t\tall    : ary => Promise.all(ary).$ ,\r\n\t\trace   : ary => Promise.race(ary).$ ,\r\n\t})\r\n\r\n\tUtil.overrides = { Promise }\r\n\r\n\tvar READY = ( _ => {\r\n\t\tfunction READY(type) {\r\n\t\t\tvar types = (arguments.length != 1) ? [].slice.call(arguments) : (Array.isArray(type)) ? type : [type]\r\n\t\t\treturn $Promise.all(types.map(type => {\r\n\t\t\t\tif (!(type in READY)) throw 'illegal READY type \"' +type+ '\"'\r\n\t\t\t\treturn READY[type]\r\n\t\t\t}))\r\n\t\t}\r\n\t\t;['DOM', 'Player', 'View'].forEach(type => {\r\n\t\t\tglobal[type] = null\r\n\t\t\tvar defer = $Promise.defer()\r\n\t\t\tREADY[type] = defer.promise\r\n\t\t\tREADY[type].ready = obj => {\r\n\t\t\t\tglobal[type] = obj\r\n\t\t\t\tdefer.resolve()\r\n\t\t\t} \r\n\t\t})\r\n\t\treturn READY\r\n\t})()\r\n\r\n\twindow.addEventListener('DOMContentLoaded', READY.DOM.ready)\r\n\r\n\r\n\tUtil.setDefaults(global, {\r\n\t\tglobal, READY, Util, LOG, Data,\r\n\t})\r\n\r\n})();","\n            for (var $__placeholder__0 = [], $__placeholder__1 = 0;\n                 $__placeholder__2 < arguments.length; $__placeholder__3++)\n              $__placeholder__4[$__placeholder__5] = arguments[$__placeholder__6];","$traceurRuntime.assertObject($__placeholder__0)","return $__placeholder__0","System.get($__placeholder__0 +'')","\r\nREADY().then(function () {\r\n\t'use strict'\r\n\r\n\t//var {Promise} = Util.overrides\r\n\r\n\tfunction setPhase(phase) { document.title = '【' +phase+ '】' }\r\n\tfunction setRunPhase(kind) { setPhase(`${kind}中...`) }\r\n\tfunction setErrorPhase(kind) { setPhase(`${kind}エラー`) }\r\n\r\n\r\n\tfunction parseScript(text) {\r\n\t\ttext = text.replace(/\\r\\n/g, '\\n').replace(/\\n+/g, '\\n').replace(/\\n/g, '\\r\\n')\r\n\t\ttext = text.replace(/^\\#.*\\n/gm, '')\r\n\t\tfunction parseOne(base, text) {\r\n\t\t\tvar chanks = text.match(/[^\\n]+?\\n(\\t+[\\s\\S]+?\\n)+/g) || []\r\n\t\t\tchanks.forEach(chank => {\r\n\t\t\t\t\r\n\t\t\t\t\tvar blocks = chank.replace(/^\\t/gm,'').replace(/\\n$/, '').match(/.+/g)\r\n\t\t\t\t\t//LOG(blocks)\r\n\t\t\t\t\tvar act = blocks.shift()\r\n\t\t\t\t\tvar data = '\\n' +blocks.join('\\n')+ '\\n'\r\n\t\t\t\t\tvar ary = []\r\n\t\t\t\t\tif (act[0] !== '・') {\r\n\t\t\t\t\t\tbase.push(['会話', [[act, blocks]]])\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t} else act = act.slice(1)\r\n\t \r\n\t\t\t\t\tif (data.match(/\\t/)) {\r\n\t\t\t\t\t\tbase.push([act, ary])\r\n\t\t\t\t\t\t//LOG(data)\r\n\t\t\t\t\t\tparseOne(ary, data)\r\n\t\t\t\t\t} else base.push([act, blocks])\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tvar base = []\r\n\t\tparseOne(base, text)\r\n\t\treturn base\r\n\r\n\t}\r\n\r\n\r\n\r\n\tfunction copyObject(obj) {\r\n\t\treturn JSON.parse(JSON.stringify(obj))\r\n\t}\r\n\r\n\r\n\tfunction otherName(name) {\r\n\t\treturn function () { return this[name].apply(this, arguments) }\r\n\t}\r\n\r\n\tfunction preloadImage(name, url, kind) {\r\n\r\n\t\tfunction loadImageTest(url) {\r\n\t\t\treturn new Promise( (ok, ng) => {\r\n\t\t\t\tvar img = new Image\r\n\t\t\t\timg.onload = _ => ok(url)\r\n\t\t\t\timg.onerror = _ => ng(`画像『${name}』のキャッシュに失敗`)\r\n\t\t\t\timg.src = url\r\n\t\t\t} )\r\n\t\t}\r\n\r\n\t\tvar hide = View.setLoadingMessage('Loadind...')\r\n\t\treturn new Promise((ok, ng) => {\r\n\t\t\t//LOG(url, Util.isNoneType(url))\r\n\t\t\tif (Util.isNoneType(name)) return ok(url)\r\n\t\t\t//url = Util.forceImageURL(url)\r\n\t\t\tloadImageTest(url).catch( _ => { \r\n\t\t\t\tvar url = Util.forceImageURL(`データ/[[共通素材]]/${kind}/${name}`, Util.Default, '')\r\n\t\t\t\treturn loadImageTest(url)\r\n\t\t\t} ).then(ok, ng)\r\n\t\t}).then( url => {\r\n\t\t\t//LOG(url)\r\n\t\t\thide()\r\n\t\t\treturn url\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tfunction runScript(script) {\r\n\r\n\t\tView.changeMode('NOVEL')\r\n\r\n\t\tvar run = Promise.defer()\r\n\t\tscript = copyObject(script)\t\r\n\r\n\t\tvar actHandlers = {\r\n\t\t\t会話(data, done, failed) {\r\n\r\n\t\t\t\tfunction nextPage() {\r\n\r\n\t\t\t\t\tvar ary = data.shift()\r\n\t\t\t\t\tif (!ary) return done()\r\n\r\n\t\t\t\t\tvar name = ary[0], texts = ary[1]\r\n\t\t\t\t\tif (Util.isNoneType(name)) name = ''\r\n\t\t\t\t\tView.nextPage(name)\r\n\r\n\t\t\t\t\tfunction nextSentence() {\r\n\t\t\t\t\t\tvar text = texts.shift()\r\n\t\t\t\t\t\tif (!text) return nextPage()\r\n\t\t\t\t\t\ttext = text.replace(/\\\\w(\\d+)/g, (_, num) => {\r\n\t\t\t\t\t\t\treturn '\\u200B'.repeat(num)\r\n\t\t\t\t\t\t}).replace(/\\\\n/g, '\\n')\r\n\t\t\t\t\t\tView.addSentence(text).on('go', nextSentence, failed)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnextSentence()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnextPage()\r\n\t\t\t},\r\n\t\t\t背景(data, done, failed) {\r\n\t\t\t\tvar name = data[0], url = Util.forceBGImageURL(name)\r\n\t\t\t\tpreloadImage(name, url, '背景').then( url => View.setBGImage({ url }) ).then(done, failed)\r\n\t\t\t},\r\n\t\t\t立絵: otherName('立ち絵'),\r\n\t\t\t立ち絵(data, done, failed) {\r\n\t\t\t\t//LOG(data)\r\n\t\t\t\tPromise.all(data.reduce((base, ary) => {\r\n\r\n\t\t\t\t\tif (Util.isNoneType(ary)) return base\r\n\r\n\t\t\t\t\tvar type = ['left','right']['左右'.indexOf(ary[0])]\r\n\t\t\t\t\tvar name = ary[1][0], url = Util.forceFDImageURL(name)\r\n\r\n\t\t\t\t\tif (!type) failed('不正な位置検出')\r\n\r\n\t\t\t\t\t//var ro = { url }\r\n\t\t\t\t\t//ro[type] = '0px'\r\n\t\t\t\t\tbase.push(preloadImage(name, url, '立ち絵').then( url => ({ url, [type]: '0px' }) ))\r\n\t\t\t\t\treturn base\r\n\t\t\t\t}, [])).then(View.setFDImages.bind(View)).then(done, failed)\r\n\t\t\t},\r\n\t\t\t選択: otherName('選択肢'),\r\n\t\t\t選択肢(data, done, failed) {\r\n\r\n\t\t\t\tView.setChoiceWindow(data.map(ary => {\r\n\t\t\t\t\treturn { name: ary[0], value: ary[1][0] }\r\n\t\t\t\t})).then(url => {\r\n\t\t\t\t\turl = Util.forceScriptURL(url)\r\n\r\n\t\t\t\t\tfetchScriptData(url).then(runScript).then(done, failed)\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tコメント(data, done, failed) {\r\n\t\t\t\tdone()\r\n\t\t\t},\r\n\r\n\t\t}\r\n\r\n\t\tfunction main_loop() {\r\n\r\n\t\t\t//var loop = Promise.defer()\r\n\r\n\t\t\tvar act, loop = new Promise( (resolve, reject) => {\r\n\r\n\t\t\t\tvar prog = script.shift()\r\n\t\t\t\tif (!prog) return run.resolve() \r\n\t\t\t\tact = prog[0]\r\n\t\t\t\tvar data = prog[1]\r\n\r\n\t\t\t\tif (act in actHandlers) actHandlers[act](data, resolve, reject)\r\n\t\t\t\telse {\r\n\t\t\t\t\tUtil.error('サポートされていないコマンド『' +act+ '』を検出しました。\\n\\nこのコマンドを飛ばして再生が継続されます。')\r\n\t\t\t\t\tresolve()\r\n\t\t\t\t}\r\n\r\n\t\t\t}).then(main_loop, err => {\r\n\t\t\t\tvar message = err ? `コマンド『${act}』で『${err}』が起こりました。` : `コマンド『${act}』が原因かもしれません。`\r\n\t\t\t\tUtil.error('スクリプトを解析中にエラーが発生しました。\\n\\n' +message+ '\\n\\nこのコマンドを保証せず再生が継続されます。')\r\n\t\t\t\treturn main_loop()\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tmain_loop()\r\n\t\treturn run.promise\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tfunction fetchSettingData(url) {\r\n\t\treturn loadText(url).then( text => {\r\n\t\t\tvar setting = parseScript(text)\r\n\t\t\tvar data = {}\r\n\t\t\tsetting.forEach( ary => {\r\n\t\t\t\tdata[ary[0]] = ary[1]\r\n\t\t\t})\r\n\t\t\treturn data\r\n\t\t} )\r\n\t}\r\n\r\n\r\n\tfunction fetchScriptData(url) {\r\n\t\turl = Util.forceScriptURL(url)\r\n\t\treturn loadText(url).then( text => parseScript(text) )\r\n\t}\r\n\r\n\r\n\tfunction loadText(url) {\r\n\t\treturn load(url, 'text')\r\n\t}\r\n\r\n\tfunction load(url, type) {\r\n\t\treturn new Promise(function (ok, ng) {\r\n\t\t\tvar xhr = new XMLHttpRequest()\r\n\t\t\txhr.onload = _ => ok(xhr.response)\r\n\t\t\txhr.onerror = ng\r\n\t\t\txhr.open('GET', url)\r\n\t\t\tif (type) xhr.responseType = type\r\n\t\t\txhr.send()\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tfunction print(message) {\r\n\t\tif (!View.print) View.changeMode('TEST')\r\n\t\tView.print(message)\r\n\t}\r\n\r\n\tREADY.Player.ready({\r\n\t\tsetRunPhase, setErrorPhase, fetchSettingData, fetchScriptData, runScript, print\r\n\t})\r\n\r\n})","\r\nREADY('Player', 'DOM').then( _ => {\r\n\t'use strict'\r\n\r\n\t//var {Promise} = Util.overrides\r\n\tvar View = null\r\n\r\n\tvar EP = Element.prototype\r\n\tUtil.setDefaults(EP, {\r\n\t\ton\t\t\t\t\t: EP.addEventListener,\r\n\t\trequestFullscreen\t: EP.webkitRequestFullscreen || EP.mozRequestFullScreen,\r\n\t\tappend\t\t\t\t: EP.appendChild,\r\n\t\tremoveChildren\t\t: function () { this.innerHTML = ''; return this },\r\n\t\tsetStyles\t\t\t: function (styles) {\r\n\t\t\tstyles = styles || {}\r\n\t\t\tObject.keys(styles).forEach( key => { this.style[key] = styles[key] }, this)\r\n\t\t\treturn this\r\n\t\t},\r\n\t})\r\n\t\r\n\tif (!document.onfullscreenchange) Object.defineProperty(document, 'onfullscreenchange', {\r\n\t\tset: val => {\r\n\t\t\tif ('onwebkitfullscreenchange' in document) document.onwebkitfullscreenchange = val\r\n\t\t\telse document.onmozfullscreenchange = val\r\n\t\t}\r\n\t})\r\n\tif (!document.fullscreenElement) Object.defineProperty(document, 'fullscreenElement', {\r\n\t\tget: _ => document.webkitFullscreenElement || document.mozFullScreenElement,\r\n\t})\r\n\r\n\r\n\r\n\tfunction DOM(tagName, styles) {\r\n\t\tif (tagName == 'text') return document.createTextNode(styles)\r\n\t\tvar el = document.createElement(tagName)\r\n\t\treturn el.setStyles(styles)\r\n\t}\r\n\r\n\r\n\tvar query    = document.querySelector.bind(document),\r\n\t    queryAll = document.querySelectorAll.bind(document)\r\n\r\n\tvar el_root    = query('#ONPwrapper'),\r\n\t\tel_wrapper = new DOM('div'),\r\n\t    el_player  = new DOM('div'),\r\n\t    el_context = new DOM('div')\r\n\r\n\t\tel_root.removeChildren()\r\n\t\tel_root.append(el_wrapper).append(el_player).append(el_context)\r\n\r\n\t//var RAF = requestAnimationFrame\r\n\r\n\r\n\r\n\tfunction adjustScale(height, ratio, full) {\r\n\r\n\t\t//LOG(arguments)\r\n\t\tvar p = Promise.resolve()\r\n\r\n\t\tif (!full) {\r\n\t\t\tel_player.style.height = '100%'\r\n\t\t\tif (height * devicePixelRatio < 480) p = View.showNotice('表示領域が小さ過ぎるため\\n表示が崩れる場合があります')\r\n\t\t}\r\n\r\n\t\tvar ratio = ratio || 16 / 9\r\n\r\n\t\tvar width = height * ratio\r\n\r\n\r\n\t\tel_player.style.fontSize = height / 25 + 'px'\r\n\r\n\t\tel_wrapper.style.height = height + 'px'\r\n\t\tel_wrapper.style.width  = width  + 'px'\r\n\t\tif (full) {\r\n\t\t\tel_player.style.height = height + 'px'\r\n\t\t\tif (el_fullscreen) el_fullscreen.style.height = height + 'px'\r\n\t\t} else fitScreen = Util.NOP \r\n\r\n\t\treturn p\r\n\r\n\t}\r\n\t\r\n\r\n\r\n\tvar el_debug = new DOM('div', {\r\n\t\twidth\t\t: '300px',\r\n\t\ttextAlign\t: 'center',\r\n\t\tfontSize\t: '1em',\r\n\t})\r\n\r\n\r\n\t;[360, 480, 720, 1080].forEach( size => {\r\n\r\n\t\tvar el = el_root.append(el_debug).append(new DOM('button'))\r\n\t\tel.append(new DOM('text', size + 'p'))\r\n\t\tel.on('click', _ =>\tadjustScale(size / devicePixelRatio) )\r\n\t})\r\n\t\r\n\tel_root.append(el_debug).append(new DOM('br'))\r\n\t\r\n\tvar el = el_root.append(el_debug).append(new DOM('button'))\r\n\tel.append(new DOM('text', 'フルウィンドウ（横）'))\r\n\tel.on('click', _ => {\r\n\t\tfitScreen = _ => {\r\n\t\t\tvar ratio = 16 / 9\r\n\t\t\tvar width = document.body.clientWidth\r\n\t\t\tvar height = width / ratio\r\n\t\t\tadjustScale(height, 0, true)\r\n\t\t}\r\n\t\tfitScreen()\r\n\t})\r\n\r\n\tvar el_fullscreen\r\n\tvar el = el_root.append(el_debug).append(new DOM('button'))\r\n\tel.append(new DOM('text', 'フルスクリーン（横）'))\r\n\tel.on('click', _ => {\r\n\t\tel_fullscreen = new DOM('div', {width: '100%', height: '100%', fontSize: '100%'})\r\n\t\tel_player.remove()\r\n\t\tel_wrapper.append(el_fullscreen).append(el_player)\r\n\t\tel_fullscreen.requestFullscreen()\r\n\t\tfitScreen = _ => {\r\n\t\t\tvar ratio = 16 / 9\r\n\t\t\tvar width = screen.width, height = screen.height\r\n\t\t\tif (height * ratio > width) height = width / ratio\r\n\t\t\tadjustScale(height, 0, true)\r\n\t\t}\r\n\t\tfitScreen()\r\n\t\tView.showNotice('この機能はブラウザにより\\n表示の差があります', 3000)\r\n\t})\r\n\r\n\r\n\r\n\r\n\tfunction setAnimate(func) {\r\n\t\tvar start = performance.now()\r\n\t\tvar cancelled = false\r\n\t\treturn new Promise(ok => {\r\n\t\t\tvar complete = _ => {\r\n\t\t\t\tcancelled = true\r\n\t\t\t\tok()\r\n\t\t\t}\r\n\t\t\tvar loop = now => {\r\n\t\t\t\tif (cancelled) return\r\n\t\t\t\tvar delta = now - start\r\n\t\t\t\tif (delta < 0) delta = 0\r\n\t\t\t\trequestAnimationFrame(loop)\r\n\t\t\t\tfunc(delta, complete)\r\n\t\t\t}\r\n\t\t\trequestAnimationFrame(loop)\r\n\t\t})\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n\tvar fitScreen = Util.NOP\r\n\twindow.onresize = _ => fitScreen()\r\n\r\n\tdocument.onfullscreenchange = _ => {\r\n\t\tvar full = document.fullscreenElement == el_fullscreen\r\n\t\t//LOG(full)\r\n\t\tif (!full) {\r\n\t\t\tel_fullscreen.remove()\r\n\t\t\tel_fullscreen.removeChildren()\r\n\t\t\tel_wrapper.append(el_player)\r\n\t\t\tadjustScale($scale, $ratio)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tvar METHODS = {}\r\n\r\n\tMETHODS = {\r\n\t\tCOMMON: {\r\n\t\t\tinitDisplay: function (opt) {\r\n\t\t\t\tUtil.setDefaults(opt, {\r\n\t\t\t\t\tbackground\t\t: 'black',\r\n\t\t\t\t\tmargin\t\t\t: 'auto',\r\n\t\t\t\t\tposition\t\t: 'relative',\r\n\t\t\t\t\thidth\t\t\t: '100%',\r\n\t\t\t\t\theight\t\t\t: '100%',\r\n\t\t\t\t\toverflow\t\t: 'hidden',\r\n\t\t\t\t//\t$height\t\t\t: 360,\r\n\t\t\t\t//\t$raito\t\t\t: 16 / 9,\r\n\t\t\t\t})\r\n\t\t\t\tvar height = opt.HEIGHT || 480\r\n\r\n\t\t\t\topt.height = opt.width = '100%'\r\n\r\n\t\t\t\tel_context = new DOM('div')\r\n\t\t\t\tel_player.removeChildren()\r\n\t\t\t\tel_player.append(el_context)\r\n\t\t\t\tel_wrapper.setStyles({ overflow\t: 'hidden', maxHeight: '100%', maxWidth: '100%' })\r\n\t\t\t\tif (!document.fullscreenElement) el_player.setStyles({ position: 'relative', overflow: 'hidden', height: '100%', width: '100%' })\r\n\t\t\t\tel_context.setStyles(opt)\r\n\t\t\t},\r\n\r\n\t\t\tshowNotice: function (message, show_time = 3000, delay_time = 500) {\r\n\t\t\t\tif (!message) throw 'illegal message string'\r\n\t\t\t\tmessage = '【！】\\n' + message\r\n\t\t\t\tvar noticeWindow = new DOM('div', {\r\n\t\t\t\t\tfontSize\t\t: '2em',\r\n\t\t\t\t\tcolor\t\t\t: 'rgba(0,0,0,0.75)',\r\n\t\t\t\t\ttextShadow\t\t: 'rgba(0,0,0,0.75) 0.01em 0.01em 0.01em',\r\n\t\t\t\t\tbackgroundColor\t: 'rgba(255,255,0,0.75)',\r\n\t\t\t\t\tboxShadow\t\t: 'rgba(100,100,0,0.5) 0px 0px 5px 5px',\r\n\t\t\t\t\tborderRadius\t: '2% / 10%',\r\n\t\t\t\t\ttextAlign\t\t: 'center',\r\n\t\t\t\t\tlineHeight\t\t: '1.5em',\r\n\t\t\t\t\topacity\t\t\t: '0',\r\n\t\t\t\t\tposition\t\t: 'absolute',\r\n\t\t\t\t\tleft\t\t\t: 'calc((100% - 90%) / 2)',\r\n\t\t\t\t\ttop\t\t\t\t: '20%',\r\n\t\t\t\t\tzIndex\t\t\t: '100',\r\n\t\t\t\t\twidth\t\t\t: '90%',\r\n\t\t\t\t})\r\n\t\t\t\tel_player.append(noticeWindow).append(new DOM('pre', {margin: '5%'})).append(new DOM('text', message))\r\n\t\t\t\treturn new Promise(function (ok, ng) {\r\n\t\t\t\t\tvar opacity = 0\r\n\t\t\t\t\tsetAnimate(function (delta, complete) {\r\n\t\t\t\t\t\topacity = delta / delay_time\r\n\t\t\t\t\t\tif (opacity >= 1) {\r\n\t\t\t\t\t\t\topacity = 1\r\n\t\t\t\t\t\t\tif (typeof navigator.vibrate == 'function') navigator.vibrate([100,100,100])\r\n\t\t\t\t\t\t\tcomplete()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnoticeWindow.style.opacity = opacity\r\n\t\t\t\t\t}).delay(show_time).and(setAnimate, (delta, complete) => {\r\n\t\t\t\t\t\topacity = 1 - delta / delay_time\r\n\t\t\t\t\t\tif (opacity <= 0) {\r\n\t\t\t\t\t\t\topacity = 0\r\n\t\t\t\t\t\t\tcomplete()\r\n\t\t\t\t\t\t\tnoticeWindow.remove()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnoticeWindow.style.opacity = opacity\r\n\t\t\t\t\t}).then(ok, ng)\r\n\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tsetLoadingMessage: function (message) {\r\n\t\t\t\tvar loadingWindow = new DOM('div', {\r\n\t\t\t\t\tfontSize\t\t: '2em',\r\n\t\t\t\t\tcolor\t\t\t: 'rgba(255,255,255,0.5)',\r\n\t\t\t\t\ttextShadow\t\t: 'rgba(0,0,0,0.5) 0.01em 0.01em 0.01em',\r\n\t\t\t\t//\ttextAlign\t\t: 'center',\r\n\t\t\t\t\tposition\t\t: 'absolute',\r\n\t\t\t\t\tright\t\t\t: '0%',\r\n\t\t\t\t\tbottom\t\t\t: '0%',\r\n\t\t\t\t\tzIndex\t\t\t: '900',\r\n\t\t\t\t//\twidth\t\t\t: 'auto',\r\n\t\t\t\t})\r\n\r\n\t\t\t\tvar defer = Promise.defer()\r\n\t\t\t\tPromise.resolve().delay(100).then(defer.resolve)\r\n\t\t\t\tdefer.promise.then( _ => el_player.append(loadingWindow).append(new DOM('pre', {margin: '0%'})).append(new DOM('text', message)) )\r\n\t\t\t\tfunction hide() { defer.reject(); loadingWindow.remove() }\r\n\t\t\t\treturn hide\r\n\r\n\t\t\t},\r\n\r\n\t\t\tadjustScale: adjustScale,\r\n\t\t},\r\n\t}\r\n\r\n\tMETHODS = {\r\n\t\tTEST: { __proto__: METHODS.COMMON,\r\n\t\t\tinitDisplay: function (opt) {\r\n\t\t\t\tUtil.setDefaults(opt, {\r\n\t\t\t\t\tfontSize\t\t: 'calc(100% * 2 / 3)',\r\n\t\t\t\t\tcolor\t\t\t: 'white',\r\n\t\t\t\t})\r\n\t\t\t\tthis.__proto__.initDisplay(opt)\r\n\t\t\t\tvar el = new DOM('div', {\r\n\t\t\t\t\tpadding: '10px',\r\n\t\t\t\t})\r\n\t\t\t\tvar el_body = new DOM('pre')\r\n\t\t\t\tthis.el_test = el_body\r\n\t\t\t\tel_context.append(el).append(el_body)\r\n\t\t\t},\r\n\t\t\tprint: function (text, opt) {\r\n\t\t\t\tthis.el_test.textContent += text\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\tNOVEL: { __proto__: METHODS.COMMON,\r\n\t\t\tinitDisplay: function (opt) {\r\n\t\t\t\tUtil.setDefaults(opt, {\r\n\t\t\t\t\tcolor\t\t\t: 'rgba(255,255,255,0.9)',\r\n\t\t\t\t//\tfontSize\t\t: 'calc(480px / 20)',\r\n\t\t\t\t\ttextShadow\t\t: 'rgba(0,0,0,0.9) 0.1em 0.1em 0.1em',\r\n\t\t\t\t\toverflow\t\t: 'hidden',\r\n\t\t\t\t})\r\n\t\t\t\tthis.__proto__.initDisplay(opt)\r\n\r\n\t\t\t\tthis.mainMessageWindow = this.addMessageWindow({z:10})\r\n\t\t\t\tthis.imageFrame = this.addImageFrame({z:20})\r\n\r\n\t\t\t},\r\n\r\n\t\t\tmessageWindowProto: {\r\n\t\t\t\tnextPage: function (name, opt) {\r\n\t\t\t\t\tname = !name || name.match(/^\\s+$/) ? '' : '【' +name+ '】' \r\n\t\t\t\t\tthis.el_title.textContent = name\r\n\t\t\t\t\tthis.el_body.removeChildren()\r\n\r\n\t\t\t\t},\r\n\t\t\t\taddSentence: function (text, opt) {\r\n\t\t\t\t\ttext += '\\n'\r\n\t\t\t\t\topt = Util.setDefaults(opt, {\r\n\t\t\t\t\t\tweight: 33\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar length = text.length\r\n\t\t\t\t\tvar at = 0\r\n\t\t\t\t\tvar el = this.el_body\r\n\t\t\t\t\tvar weight = opt.weight\r\n\t\t\t\t\tvar [aborted, cancelled] = [false, false]\r\n\t\t\t\t\tvar [abort, cancel] = [_ => aborted = true, _ => cancelled = true]\r\n\t\t\t\t\tView.on('go').then(cancel)\r\n\r\n\t\t\t\t\tvar p = setAnimate( (delay, complete) => {\r\n\t\t\t\t\t\tif (aborted) return complete()\r\n\t\t\t\t\t\tif (cancelled) {\r\n\t\t\t\t\t\t\tel.append(new DOM('text', text.slice(at).replace(/\\u200B/g, '') ))\r\n\t\t\t\t\t\t\treturn complete()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile (delay / weight >= at) {\r\n\t\t\t\t\t\t\tvar str = text[at]\r\n\t\t\t\t\t\t\tif (str != '\\u200B') el.append(new DOM('text', str))\r\n\t\t\t\t\t\t\tif (++at >= length) return complete()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tp.abort = abort\r\n\t\t\t\t\tp.cancel = cancel\r\n\t\t\t\t\treturn p\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\taddMessageWindow: function (opt) {\r\n\t\t\t\tUtil.setDefaults(opt, {\r\n\t\t\t\t\tbackground\t\t: 'rgba(0,0,100,0.5)',\r\n\t\t\t\t\tboxShadow\t\t: 'rgba(0,0,100,0.5) 0px 0px 5px 5px',\r\n\t\t\t\t\tborderRadius\t: '1% / 1%',\r\n\t\t\t\t\twidth\t\t\t: 'calc(100% - 10px - (2% + 2%))',\r\n\t\t\t\t\theight\t\t\t: 'calc( 25% - 10px - (4% + 2%))',\r\n\t\t\t\t\tfontSize\t\t: '100%',\r\n\t\t\t\t\tlineHeight\t\t: '1.5em',\r\n\t\t\t\t\tfontWeight\t\t: 'bold',\r\n\t\t\t\t\tpadding\t\t\t: '4% 2% 2% 2%',\r\n\t\t\t\t\twhiteSpace\t\t: 'nowrap',\r\n\t\t\t\t\tposition\t\t: 'absolute',\r\n\t\t\t\t\tbottom\t\t\t: '5px',\r\n\t\t\t\t\tleft\t\t\t: '5px',\r\n\t\t\t\t\tzIndex\t\t\t: opt.z || 1400,\r\n\r\n\t\t\t\t})\r\n\t\t\t\tvar el = new DOM('div', opt)\r\n\t\t\t\tel_context.append(el)\r\n\r\n\t\t\t\tvar el_title = el.append(new DOM('div', {\r\n\t\t\t\t\tdisplay\t\t\t: 'inline-block',\r\n\t\t\t\t\tmarginRight\t\t: '5%',\r\n\t\t\t\t//\tcolor\t\t\t: 'blue',\r\n\t\t\t\t\ttextAlign\t\t: 'right',\r\n\t\t\t\t\tverticalAlign\t: 'top',\r\n\t\t\t\t\twidth\t\t\t: '15%',\r\n\t\t\t\t\theight\t\t\t: '100%',\r\n\t\t\t\t//\tbackground\t\t: 'rgba(255,100,200,0.5)',\r\n\t\t\t\t//\tpadding\t\t\t: '5px',\r\n\t\t\t\t}))\r\n\t\t\t\tvar el_body = el.append(new DOM('div', {\r\n\t\t\t\t\tdisplay\t\t\t: 'inline-block',\r\n\t\t\t\t\twidth\t\t\t: 'auto',\r\n\t\t\t\t\theight\t\t\t: '100%',\r\n\t\t\t\t//\tpadding\t\t\t: '15px',\r\n\t\t\t\t})).append(new DOM('pre', {\r\n\t\t\t\t\tmargin\t\t\t: '0',\r\n\t\t\t\t}))\r\n\r\n\t\t\t\tvar mw = { __proto__: this.messageWindowProto,\r\n\t\t\t\t\tel\t\t\t\t: el,\r\n\t\t\t\t\tel_title\t\t: el_title,\r\n\t\t\t\t\tel_body\t\t\t: el_body,\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn mw\r\n\t\t\t},\r\n\r\n\t\t\taddImageFrame: function (opt) {\r\n\r\n\t\t\t\tvar fr = new DOM('div', {\r\n\t\t\t\t\theight\t\t\t: '100%',\r\n\t\t\t\t\twidth\t\t\t: '100%',\r\n\t\t\t\t\tzIndex\t\t\t: opt.z || 1500,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tel_context.append(fr)\r\n\t\t\t\treturn fr\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetChoiceWindow: function (opts) {\r\n\r\n\t\t\t\tvar defer = Promise.defer()\r\n\r\n\t\t\t\tvar cw = new DOM('div', {\r\n\t\t\t\t\tposition\t\t: 'absolute',\r\n\t\t\t\t\tleft\t\t\t: 'calc((100% - 70%) / 2 - 5%)',\r\n\t\t\t\t\twidth\t\t\t: '70%',\r\n\t\t\t\t\ttop\t\t\t\t: '10%', \r\n\t\t\t\t\tboxShadow\t\t: 'rgba(100, 100, 255, 0.5) 0 0 2em',\r\n\t\t\t\t\tborderRadius\t: '3% / 5%',\r\n\t\t\t\t\tbackground\t\t: 'rgba(100, 100, 255, 0.3)',\r\n\t\t\t\t\tpadding\t\t\t: '3% 5%',\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t\topts.forEach(function (opt) {\r\n\t\t\t\t\tif (!('value' in opt)) opt.value = opt.name\r\n\t\t\t\t\tvar bt = new DOM('button', {\r\n\t\t\t\t\t\tdisplay\t\t\t: 'block',\r\n\t\t\t\t\t\tfontSize\t\t: '1.5em',\r\n\t\t\t\t\t\tboxShadow\t\t: 'inset 0 1px 3px #F1F1F1, inset 0 -15px rgba(0,0,223,0.2), 1px 1px 2px #E7E7E7',\r\n\t\t\t\t\t\tbackground\t\t: 'rgba(0,0,100,0.8)',\r\n\t\t\t\t\t\tcolor\t\t\t: 'white',\r\n\t\t\t\t\t\tborderRadius\t: '5% / 50%',\r\n\t\t\t\t\t\twidth\t\t\t: '100%',\r\n\t\t\t\t\t\theight\t\t\t: '2.5em',\r\n\t\t\t\t\t\tmargin\t\t\t: '5% 0%',\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbt.append(new DOM('text', opt.name))\r\n\t\t\t\t\tbt.onclick = _ => {\r\n\t\t\t\t\t\tdefer.resolve(opt.value)\r\n\t\t\t\t\t\tcw.remove()\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcw.append(bt)\r\n\t\t\t\t})\r\n\r\n\t\t\t\tel_context.append(cw)\r\n\r\n\t\t\t\treturn defer.promise\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetBGImage: function (opt) {\r\n\t\t\t\tvar url = opt.url ? `url(${opt.url})` : 'none'\r\n\t\t\t\tel_context.style.backgroundImage = url\r\n\t\t\t\tel_context.style.backgroundSize = 'cover'\r\n\t\t\t},\r\n\r\n\t\t\tsetFDImages: function (opts) {\r\n\t\t\t\tvar el = this.imageFrame\r\n\t\t\t\tel.removeChildren()\r\n\t\t\t\topts.forEach( opt => {\r\n\t\t\t\t\tvar img = new DOM('img', {\r\n\t\t\t\t\t\tposition\t\t: 'absolute',\r\n\t\t\t\t\t\tleft\t\t\t: opt.left  || '',\r\n\t\t\t\t\t\tright\t\t\t: opt.right || '',\r\n\t\t\t\t\t\tmaxWidth\t\t: '50%',\r\n\t\t\t\t\t\theight\t\t\t: '100%',\r\n\t\t\t\t\t})\r\n\t\t\t\t\timg.src = opt.url\r\n\t\t\t\t\tel.append(img)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tnextPage: function (name, opt) {\r\n\t\t\t\tthis.mainMessageWindow.nextPage(name, opt)\r\n\t\t\t},\r\n\r\n\t\t\taddSentence: function (text, opt) {\r\n\t\t\t\treturn this.mainMessageWindow.addSentence(text, opt)\r\n\t\t\t},\r\n\r\n\t\t},\r\n\r\n\t}\r\n\r\n\r\n\r\n\tvar ViewProto = { __proto__: METHODS.COMMON,\r\n\t\t//get el_wrapper() { return el_wrapper },\r\n\t\tfresh: function () {\r\n\t\t\tView = { __proto__: ViewProto }\r\n\t\t},\r\n\t\tclean: function () {\r\n\t\t\tthis.changeMode($mode)\r\n\t\t},\r\n\t\tinit: function (opt) {\r\n\t\t\tthis.initDisplay(opt.style || {})\r\n\t\t},\r\n\t\tinitDisplay: function (opt) {\r\n\t\t\tthis.__proto__.initDisplay(opt)\r\n\t\t},\r\n\t\tchangeMode: function (type, opt) {\r\n\t\t\tvar type = type.toUpperCase()\r\n\t\t\topt = opt || {}\r\n\r\n\t\t\tif (!type in METHODS) throw 'illegal ViewContext mode type'\r\n\r\n\t\t\t$mode = type\r\n\t\t\tViewProto.__proto__ = METHODS[type]\r\n\t\t\tView.init(opt)\r\n\r\n\t\t},\r\n\t\tchangeModeIfNeeded: function (type, opt) {\r\n\t\t\tif ($mode != type) this.changeMode(type, opt)\r\n\t\t},\r\n\t\ton: function (type, onFulfilled, onRejected) {\r\n\r\n\t\t\t return new Promise( resolve => {\r\n\t\t\t\t\r\n\t\t\t\tswitch (type) {\r\n\r\n\t\t\t\t\tcase 'go':\r\n\t\t\t\t\t\thookInput(['Lclick', 'enter', 'space'], resolve)\r\n\t\t\t\t\tbreak\r\n\r\n\t\t\t\t\tdefault: throw 'illegal hook event type'\t\t\r\n\t\t\t\t}\r\n\t\t\t}).then(onFulfilled).catch(onRejected)\r\n\r\n\t\t},\r\n\t}\r\n\r\n\tViewProto.fresh()\r\n\r\n\r\n\r\n\tvar hookInput = (_ => {\r\n\r\n\t\tvar keyboardTable = {\r\n\t\t\t13: 'enter',\r\n\t\t\t32: 'space',\r\n\t\t}\r\n\r\n\t\tvar hooks = []\r\n\r\n\t\tdocument.addEventListener('keydown', evt => {\r\n\t\t\tvar type = keyboardTable[evt.keyCode]\r\n\t\t\tif (type) onEvent(type, evt)\r\n\t\t})\r\n\r\n\t\tel_wrapper.addEventListener('mousedown', evt => {\r\n\t\t\tvar type = 'LMR'[evt.button]\r\n\t\t\tif (type) onEvent(type + 'click', evt)\r\n\t\t})\r\n\r\n\t\tfunction onEvent(type, evt) {\r\n\t\t\tevt.preventDefault()\r\n\t\t\thooks = hooks.reduce( (ary, hook, i) => {\r\n\t\t\t\tif (hook.indexOf(type) === -1) ary.push(hook)\r\n\t\t\t\telse hook.resolve()\r\n\t\t\t\treturn ary\r\n\t\t\t}, [])\r\n\t\t}\r\n\r\n\t\treturn function hookInput(hook, resolve) {\r\n\t\t\thook.resolve = resolve\r\n\t\t\thooks.push(hook)\r\n\t\t}\r\n\t})()\r\n\r\n\r\n\tvar $full = false\r\n\tvar $ratio = 16 / 9\r\n\tvar $mode = ''\r\n\tvar width = document.body.clientWidth\r\n\tvar $scale = width / $ratio >= 480 ? 480 : width / $ratio\r\n\t//document.body.style.width = '100%'\r\n\r\n\tView.changeMode('TEST')\r\n\tvar p = adjustScale($scale, $ratio)\r\n\r\n\tp.then( _ => READY.View.ready(View) )\r\n\r\n})","\r\nREADY('Player', 'View').next('起動', _ => {\r\n\t'use strict'\r\n\r\n\t//var {Promise} = Util.overrides\r\n\r\n\tPlayer.fetchSettingData(Data.URL.EngineSetting).then(setting => {\r\n\t\tData.SystemVersion = setting['システムバージョン'][0]\r\n\t\treturn message( 'openノベルプレイヤー by Hikaru02\\n\\nシステムバージョン：　' + Data.SystemVersion)\r\n\t}).delay(1000).next('準備', setup)\r\n\r\n\r\n\tvar message = (_ => {\r\n\t\tvar abort = Util.NOP\r\n\t\treturn text => {\r\n\t\t\tabort()\r\n\t\t\tView.changeModeIfNeeded('NOVEL')\r\n\t\t\tView.nextPage('システム')\r\n\t\t\tvar p = View.addSentence(text, { weight: 20 })\r\n\t\t\tabort = p.abort\r\n\t\t\treturn p\r\n\t\t}\r\n\t})()\r\n\r\n\r\n\r\n\tfunction setup() {\r\n\r\n\t\tmessage('作品一覧を読み込んでいます...')\r\n\r\n\t\tPlayer.fetchSettingData(Data.URL.ContentsSetting).then(setting => {\r\n\r\n\t\t\tmessage('再生する作品を選んでください')\r\n\t\t\treturn View.setChoiceWindow(setting['作品'].reduce( (opts, name) => {\r\n\t\t\t\topts.push({ name })\r\n\t\t\t\treturn opts\r\n\t\t\t}, []))\r\n\r\n\t\t}).then(scenarioSetup)\r\n\r\n\r\n\t}\r\n\r\n\r\n\tfunction scenarioSetup(name) {\r\n\r\n\t\tmessage('作品情報を読み込んでいます...')\r\n\t\t//var hideLodingMessade = View.setLoadingMessage('Loading...')\r\n\r\n\t\tPlayer.baseURL = ''\r\n\r\n\t\tvar url = Util.forceURL('設定', 'txt', name)\r\n\t\t\r\n\t\tPlayer.baseURL = name\r\n\r\n\t\tfunction fetchFirstScriptData(setting) {\r\n\t\t\tmessage('開始シナリオを読み込んでいます...')\r\n\t\t\tvar url = setting['開始シナリオ'][0]\r\n\t\t\treturn Player.fetchScriptData(url)\r\n\t\t}\r\n\r\n\r\n\t\tPlayer.fetchSettingData(url).then(fetchFirstScriptData).next('待機', script => {\r\n\r\n\r\n\t\t\tmessage('再生準備が完了しました。\\nクリック、タップ、エンターキー、スペースキーで進みます。').delay(1000).next('実行', _ => {\r\n\r\n\t\t\t\treturn Player.runScript(script)\r\n\r\n\t\t\t}).next('待機', _ => {\r\n\r\n\t\t\t\tView.clean()\r\n\t\t\t\treturn message('再生が終了しました。\\n作品選択メニューに戻ります。')\r\n\r\n\t\t\t}).delay(1000).next('準備', setup)\r\n\r\n\t\t})\r\n\r\n\t}\r\n\r\n\r\n})\r\n\r\n\r\n"]}